/*
 * relativeSlider 1.0.0 - multi level grouping indicators for tables
 * Version 1.0.0
 * @requires jQuery v1.6+ and jQuery.ui
 * 
 * Copyright (c) 2014 Perry Systems
 * Dual licensed under the MIT and GPL licenses:
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.gnu.org/licenses/gpl.html
 */
/*
 * @description jQuery plugin to calculate the relative worth of individual sliders relative to the total selected value..
 * @example $('.skills-slider').relativeSlider('init');
 */
!function(e){e.fn.relativeSlider=function(a,r){var t={};if(t.callers=this,t.percentageFixer=function(e,a){function r(e,a){return Math.abs(e-a)/e}for(var t,n,i,s,l=e.length,o=0,c=0,u=[],h=e.length,v=[];l--;)c+=u[l]=Math.round(e[l]);for(t=a>c?1:-1;c!==a;){for(l=0;h>l;l++)n=l===h-1?0:l+1,s=r(e[n],u[n]+t),i=r(e[l],u[l]+t),i>s&&(o=n);u[o]+=t,c+=t}for(l=0;h>l;l++)v[l]=u[l]&&Math.abs(e[l]-u[l])/e[l];for(l=0;h>l;l++)for(o=0;h>o;o++)if(o!==l){var f=r(e[l],u[l]+1)+r(e[o],u[o]-1),g=r(e[l],u[l]-1)+r(e[o],u[o]+1),d=v[l]+v[o];d>f&&(u[l]=u[l]+1,u[o]=u[o]-1,v[l]=u[l]&&Math.abs(e[l]-u[l])/e[l],v[o]=u[o]&&Math.abs(e[o]-u[o])/e[o]),d>g&&(u[l]=u[l]-1,u[o]=u[o]+1,v[l]=u[l]&&Math.abs(e[l]-u[l])/e[l],v[o]=u[o]&&Math.abs(e[o]-u[o])/e[o])}return u},t.settings=e.extend({},r),t.calculateSliders=function(){var a={},r=0,n={},i=t.callers.length;t.callers.each(function(){var a=e(this),t=parseInt(a.slider("value"));r+=t,n[a.attr("id")]={value:t}});var s=[];for(var l in n){var o=100/r*n[l].value;s.push(o)}if(r>0){var c=t.percentageFixer(s,100),u=0;for(var l in n)n[l].percentage=c[u],u++}else for(var l in n)n[l].percentage=0;return a.totalValue=r,a.slidersCount=i,a.sliders=n,a},"init"===a){var n=t.callers.each(function(){var a=e(this),r=parseInt(a.text());e(this).empty().slider({value:r,min:0,max:100,range:"min",animate:!0,orientation:"horizontal",change:t.settings.onChange}).css({visibility:"visible"})});return t.settings.onChange.apply(this,[]),n}return"calculate"===a?t.calculateSliders():void 0}}(jQuery);